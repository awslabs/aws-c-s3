include(AwsTestHarness)
enable_testing()

file(GLOB TEST_SRC "*.c")
file(GLOB TEST_HDRS "*.h")
file(GLOB TESTS ${TEST_HDRS} ${TEST_SRC})

add_test_case(test_s3_client_create_destroy)
add_test_case(test_s3_request_create_destroy)

add_test_case(test_s3_client_exceed_retries)
add_test_case(test_s3_client_acquire_connection_fail)
add_test_case(test_s3_meta_request_fail_next_request)
add_test_case(test_s3_meta_request_fail_prepare_request)
add_test_case(test_s3_meta_request_sign_request_fail)
add_test_case(test_s3_meta_request_send_request_finish_fail)
add_test_case(test_s3_auto_range_put_missing_upload_id)

add_test_case(test_s3_vip_create_destroy)
add_test_case(test_s3_client_add_remove_vips)
add_test_case(test_s3_client_resolve_vips)

add_test_case(test_s3_get_object_tls_disabled)
add_test_case(test_s3_get_object_tls_enabled)
add_test_case(test_s3_get_object_tls_default)
add_test_case(test_s3_get_object_less_than_part_size)
add_test_case(test_s3_get_object_multiple)
add_test_case(test_s3_get_object_sse_kms)
add_test_case(test_s3_get_object_sse_aes256)
add_test_case(test_s3_no_signing)
add_test_case(test_s3_signing_override)
add_test_case(test_s3_put_object_tls_disabled)
add_test_case(test_s3_put_object_tls_enabled)
add_test_case(test_s3_put_object_tls_default)
add_test_case(test_s3_multipart_put_object_with_acl)
add_test_case(test_s3_put_object_less_than_part_size)
add_test_case(test_s3_put_object_sse_kms)
add_test_case(test_s3_put_object_sse_kms_multipart)
add_test_case(test_s3_put_object_sse_aes256)
add_test_case(test_s3_put_object_sse_aes256_multipart)
add_test_case(test_s3_meta_request_default)
add_test_case(test_s3_put_object_fail_headers_callback)
add_test_case(test_s3_put_object_fail_body_callback)
add_test_case(test_s3_get_object_fail_headers_callback)
add_test_case(test_s3_get_object_fail_body_callback)
add_test_case(test_s3_default_fail_headers_callback)
add_test_case(test_s3_default_fail_body_callback)
add_test_case(test_s3_error_response)
add_test_case(test_s3_existing_host_entry)
add_test_case(test_s3_cancel_multipart_upload_during_parts_upload)
add_test_case(test_s3_cancel_multipart_upload_random)
add_test_case(test_s3_cancel_singlepart_upload_random)
add_test_case(test_s3_cancel_multipart_download_random)
add_test_case(test_s3_cancel_singlepart_download_random)
add_test_case(test_s3_put_fail_object_invalid_request)
add_test_case(test_s3_put_fail_object_inputstream_fail_reading)
add_test_case(test_s3_put_single_part_fail_object_inputstream_fail_reading)
# TODO add_test_case(MORE determinstic cancel tests based on state)
add_test_case(test_s3_bad_endpoint)
add_test_case(test_s3_put_object_clamp_part_size)
add_test_case(test_s3_replace_quote_entities)
add_test_case(test_s3_different_endpoints)

add_test_case(test_get_existing_compute_platform_info)
add_test_case(test_get_nonexistent_compute_platform_info)

set(TEST_BINARY_NAME ${PROJECT_NAME}-tests)
generate_test_driver(${TEST_BINARY_NAME})
